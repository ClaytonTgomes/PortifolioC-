using System;
using System.Collections.Generic;
using System.Linq;

public class Carta
{
    public string Nome { get; set; }
    public int Vida { get; set; }
    public int AtkLeve { get; set; }
    public int AtkForte { get; set; }
    public int CustoAtkL { get; set; }
    public int CustoAtkF { get; set; }

    public Carta(string nome, int vida, int atkLeve, int atkForte, int custoAtkL, int custoAtkF)
    {
        Nome = nome;
        Vida = vida;
        AtkLeve = atkLeve;
        AtkForte = atkForte;
        CustoAtkL = custoAtkL;
        CustoAtkF = custoAtkF;
    }
}

class Program
{
    static void Main(string[] args)
    {
        // Criar uma listas de Cartas
        List<Carta> baralho = CriarBaralho();
        List<Carta> mao = new List<Carta>();
        List<Carta> campo = new List<Carta>();
        List<Carta> maoDois = new List<Carta>();
        List<Carta> campo2 = new List<Carta>();
        List<Carta> descarteJogador = new List<Carta>();
        List<Carta> descarteMaquina = new List<Carta>();

        Random dados = new Random();
        Carta cartaAtual;
        Carta cartaAtualMaq;

        int descarte = 0;
        int custoATK1 = 0; //Valor que receberá da moeda1 jogador
        int custoATK2 = 0; //Valor que recebera da moeda2 maquina
        int moeda1 = 0; //Valor que recebera sortido de random jogador
        int moeda2 = 0; //Valor que receberá sortido de random maquina
        int custAtkL1;
        int custAtkF1;
        int custAtkL2;
        int custAtkF2;
        bool situaçãoJogo = true;
        bool situacaoFase = true;

        //Embaralhar Lista
        baralho = Embaralhar(baralho);

        static List<Carta> Embaralhar(List<Carta> baralho)
        {
            Random random = new Random();
            int n = baralho.Count;
            while (n > 1)
            {
                int k = random.Next(n);
                n--;
                Carta carta = baralho[k];
                baralho[k] = baralho[n];
                baralho[n] = carta;
            }
            return baralho;
        }

        static List<Carta> CriarBaralho()
        {
            List<Carta> baralho = new List<Carta>();
            //Adicionar as cartas ao baralho
            baralho.Add(new Carta("Pikachu", 80, 30, 60, 2, 3));
            baralho.Add(new Carta("Charmander", 70, 20, 40, 1, 3));
            baralho.Add(new Carta("Squirtle", 60, 10, 30, 1, 2));
            baralho.Add(new Carta("Bulbasaur", 70, 20, 30, 1, 2));
            baralho.Add(new Carta("Mew", 180, 40, 70, 2, 4));
            baralho.Add(new Carta("Onix", 90, 10, 40, 1, 2));
            baralho.Add(new Carta("Lapras", 190, 100, 160, 5, 7));
            baralho.Add(new Carta("Arceus", 280, 150, 220, 6, 8));
            baralho.Add(new Carta("Charizard", 220, 80, 180, 4, 7));
            baralho.Add(new Carta("Venusaur", 160, 50, 90, 3, 4));
            baralho.Add(new Carta("Rayquaza", 90, 30, 100, 2, 5));
            baralho.Add(new Carta("Lugia", 90, 40, 90, 2, 4));
            baralho.Add(new Carta("Xerneas", 170, 60, 140, 3, 6));
            baralho.Add(new Carta("Zaptos", 90, 60, 100, 3, 5));
            baralho.Add(new Carta("Moltres", 120, 30, 90, 2, 4));
            baralho.Add(new Carta("Articuno", 110, 20, 100, 1, 5));
            baralho.Add(new Carta("Charmeleon", 90, 30, 100, 2, 5));
            baralho.Add(new Carta("Ivysaur", 100, 30, 80, 2, 4));
            baralho.Add(new Carta("Mewtwo", 220, 50, 160, 3, 5));
            baralho.Add(new Carta("Wartotle", 70, 30, 70, 2, 4));
            baralho.Add(new Carta("Ho-Oh", 190, 100, 180, 5, 7));
            baralho.Add(new Carta("Entei", 230, 60, 260, 3, 9));

            return baralho;
        }

        void Baralho()
        {
            Console.WriteLine("CARTAS DO BARALHO");
            Console.WriteLine("N° - Nome = Vida, AtaqueLeve-Energia / AtaqueForte-Energia");
            foreach (Carta deck in baralho)
            {
                Console.WriteLine($"{deck.Nome} = {deck.Vida} ( {deck.AtkLeve} - E {deck.CustoAtkL}  / {deck.AtkForte} - E {deck.CustoAtkF} )");
            }
        }

        // Criar a impressão das cartas na lista mao
        void Mao()
        {
            int i = 0;
            Console.WriteLine("MÃO");
            Console.WriteLine("N°-> Nome  =  Vida | ( AtaqueLeve-E / AtaqueForte-E)");
            foreach (Carta carta in mao)
            {
                Console.WriteLine($"{i} -> {carta.Nome} =  V {carta.Vida} | (AL {carta.AtkLeve}-{carta.CustoAtkL}  / AF {carta.AtkForte}-{carta.CustoAtkF})");
                i++;
            }
        }

        void Mao2()
        {
            int i = 0;
            Console.WriteLine("MÃO MAQUINA");
            Console.WriteLine("Nome  =  Vida | ( AtaqueLeve-E / AtaqueForte-E)");
            foreach (Carta carta2 in maoDois)
            {
                Console.WriteLine($"{carta2.Nome} = V {carta2.Vida} | (AL {carta2.AtkLeve}-{carta2.CustoAtkL}  / AF {carta2.AtkForte}-{carta2.CustoAtkF})");
                i++;
            }
        }

        void RodarDadosJogador()
        {
            moeda1 = dados.Next(1, 3);
            Console.WriteLine("Valor energia pego: " + moeda1);
        }

        void RodarDadosMaquina()
        {
            moeda2 = dados.Next(1, 3);
            Console.WriteLine("Valor energia pego: " + moeda2);
        }

        void Campo()
        {
            Console.ForegroundColor = ConsoleColor.Blue;
            Console.WriteLine("\t\t******  CAMPO  ******");
            Console.WriteLine("==================================================================================");
            Console.ResetColor();
            Console.ForegroundColor = ConsoleColor.Green;
            Console.WriteLine("Pokemons nocauteado Jogador " + descarteJogador.Count);
            Console.WriteLine();
            Console.WriteLine("Quantidade de Energia Jogador: " + custoATK1);
            Console.WriteLine("\t\t\t\tSeu Pokemon");
            foreach (Carta jogada1 in campo)
            {
                Console.WriteLine($"\t\t{jogada1.Nome} = V {jogada1.Vida} | (AL {jogada1.AtkLeve}-{jogada1.CustoAtkL}  / AF {jogada1.AtkForte}-{jogada1.CustoAtkF})");
            }
            Console.WriteLine();
            Console.ResetColor();
            Console.ForegroundColor = ConsoleColor.Blue;
            Console.WriteLine("                                     -------                                      ");
            Console.WriteLine("------------------------------------|   O   |-------------------------------------");
            Console.WriteLine("                                     -------                                      ");
            Console.ResetColor();
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine();
            foreach (Carta jogada2 in campo2)
            {
                Console.WriteLine($"\t\t{jogada2.Nome} = V {jogada2.Vida} | (AL {jogada2.AtkLeve}-{jogada2.CustoAtkL}  / AF {jogada2.AtkForte}-{jogada2.CustoAtkF})");
            }
            Console.WriteLine("\t\t\t\tMaquina Pokemon");
            Console.WriteLine("Quantidade de Energia Maquina: " + custoATK2);
            Console.WriteLine();
            Console.WriteLine("Pokemons nocauteado Maquina " + descarteMaquina.Count);
            Console.ResetColor();
            Console.ForegroundColor = ConsoleColor.Blue;
            Console.WriteLine("==================================================================================");
            Console.ResetColor();
        }

        void DistribuirCartasInicial()
        {
            for (int i = 0; i < 4; i++)
            {
                int posicao = 0;
                mao.Add(baralho[posicao]);
                baralho.RemoveAt(posicao);
            }

            for (int i = 0; i < 4; i++)
            {
                Random maoMaq = new Random();
                int posicao = maoMaq.Next(4);
                maoDois.Add(baralho[posicao]);
                baralho.RemoveAt(posicao);
            }
        }

        void VerificarCampoJogador()
        {
            if (campo.Count == 0)
            {
                Mao();
                Console.WriteLine();
                Console.WriteLine("Qual carta vai jogar no campo?");
                descarte = int.Parse(Console.ReadLine());
                campo.Add(mao[descarte]);
                mao.RemoveAt(descarte);
                mao.Add(baralho[0]);
                baralho.RemoveAt(0);
            }
        }

        void VerificarCampoMaquina()
        {
            if (campo2.Count == 0)
            {
                campo2.Add(maoDois[0]);
                maoDois.RemoveAt(0);
                maoDois.Add(baralho[0]);
                baralho.RemoveAt(0);
            }
        }

        void VerificarAtaque()
        {
            custAtkL1 = cartaAtual.CustoAtkL;
            custAtkF1 = cartaAtual.CustoAtkF;

            if (custoATK1 >= custAtkL1)
            {
                Console.WriteLine("Você tem energia para atacar");
                Console.WriteLine("Vai atacar? S ou N");
                char atacar = char.Parse(Console.ReadLine());
                while (atacar != 's' && atacar != 'S' && atacar != 'n' && atacar != 'N')
                {
                    Console.WriteLine("Escolha invalida, tente novamente. S ou N");
                    atacar = char.Parse(Console.ReadLine());
                }

                if (atacar == 's' || atacar == 'S')
                {
                    Console.WriteLine("Ataque leve ou forte? L ou F");
                    atacar = char.Parse(Console.ReadLine());
                    if (atacar == 'l' || atacar == 'L')
                    {
                        Console.WriteLine();
                        cartaAtualMaq.Vida -= cartaAtual.AtkLeve;
                        custoATK1 -= 2;
                        if (custoATK1 < 0)
                        {
                            custoATK1 = 0;
                        }
                        Console.WriteLine(cartaAtual.Nome + " Atacou com o Leve o Pokemon " + cartaAtualMaq.Nome);
                        Console.WriteLine("Dano de ataque foi de " + cartaAtual.AtkLeve + " do pokemon " + cartaAtual.Nome);
                        Console.WriteLine("Vida atual do Pokemon " + cartaAtualMaq.Nome + " agora é de " + cartaAtualMaq.Vida);
                    }
                    else if (atacar == 'f' || atacar == 'F')
                    {
                        if (custoATK1 >= custAtkF1)
                        {
                            Console.WriteLine();
                            cartaAtualMaq.Vida -= cartaAtual.AtkForte;
                            custoATK1 -= 4;
                            if (custoATK1 < 0)
                            {
                                custoATK1 = 0;
                            }
                            Console.WriteLine(cartaAtual.Nome + " Atacou com Forte o Pokemon " + cartaAtualMaq.Nome);
                            Console.WriteLine("Dano de ataque foi de " + cartaAtual.AtkForte + " do pokemon " + cartaAtual.Nome);
                            Console.WriteLine("Vida atual do Pokemon " + cartaAtualMaq.Nome + " agora é de " + cartaAtualMaq.Vida);
                        }
                        else
                        {
                            Console.WriteLine("Você nãotem energia Para ataque Forte");
                        }
                    }
                }
                else
                {
                    Console.WriteLine("Não fez o ataque");
                }
            }
        }

        void VerificarAtaqueMaquina()
        {
            custAtkL2 = cartaAtualMaq.CustoAtkL;
            custAtkF2 = cartaAtualMaq.CustoAtkF;

            if (campo.Count > 0)
            {
                if (custoATK2 >= cartaAtualMaq.CustoAtkF)
                {
                    cartaAtual.Vida -= cartaAtualMaq.AtkForte;
                    custoATK2 -= 4;
                    if (custoATK2 < 0)
                    {
                        custoATK2 = 0;
                    }
                    Console.WriteLine(cartaAtualMaq.Nome + "Fez Ataque Forte no " + cartaAtual.Nome);
                    Console.WriteLine("Dano de ataque foi de " + cartaAtualMaq.AtkForte + " do pokemon " + cartaAtualMaq.Nome);
                    Console.WriteLine("Vitalidade atual do Pokemon " + cartaAtual.Nome + " agora é de " + cartaAtual.Vida);
                }
                else if (custoATK2 >= cartaAtualMaq.CustoAtkL)
                {
                    Random rnd = new Random();
                    int decidAtacar = rnd.Next(2);
                    if (decidAtacar == 0)
                    {
                        Console.WriteLine("Decidiu não atacar");
                    }
                    else
                    {
                        cartaAtual.Vida -= cartaAtualMaq.AtkLeve;
                        custoATK2 -= 2;
                        if (custoATK2 < 0)
                        {
                            custoATK2 = 0;
                        }
                        Console.WriteLine(cartaAtualMaq.Nome + "Fez Ataque Leve no " + cartaAtual.Nome);
                        Console.WriteLine("Dano de ataque foi de " + cartaAtualMaq.AtkLeve + " do pokemon " + cartaAtualMaq.Nome);
                        Console.WriteLine("Vitalidade atual do Pokemon " + cartaAtual.Nome + " agora é de " + cartaAtual.Vida);
                    }
                }
                else
                {
                    Console.WriteLine("Não tem Energia suficiente");
                }
            }
        }

        void PercaPokemonJogador()
        {
            if (cartaAtual.Vida <= 0)
            {
                Console.WriteLine("Seu Pokemon foi nocauteado " + cartaAtual.Nome);
                descarteJogador.Add(campo[0]);
                campo.RemoveAt(0);
            }
        }

        void PercaPokemonMaquina()
        {

            if (cartaAtualMaq.Vida <= 0)
            {
                Console.WriteLine("Pokemon nocauteado da Maquina " + cartaAtualMaq.Nome);
                descarteMaquina.Add(campo2[0]);
                campo2.RemoveAt(0);
            }
        }

        void VerificarVitoriaJogador()
        {
            if (descarteMaquina.Count == 5)
            {
                Console.WriteLine();
                Console.WriteLine("VOCÊ Ganhou o jogo");
                situaçãoJogo = false;
            }
        }

        void VerificarVitoriaMaquina()
        {
            if (descarteJogador.Count == 5)
            {
                Console.WriteLine();
                Console.WriteLine("MAQUINA Ganhou o jogo");
                situaçãoJogo = false;
            }
        }

        DistribuirCartasInicial();
        Campo();
        Console.WriteLine();
        VerificarCampoJogador();
        VerificarCampoMaquina();
        Console.WriteLine("Aperte ENTER para continuar");
        Console.ReadLine();
        Console.Clear();

        //Controle Geral do Jogo
        while (situaçãoJogo == true)
        {
            //Turno jogador
            cartaAtual = campo[0];
            cartaAtualMaq = campo2[0];
            while (true)
            {
                Console.WriteLine("################################# Sua Vez #####################################");
                Console.ForegroundColor = ConsoleColor.Green;
                RodarDadosJogador();
                custoATK1 += moeda1;
                Console.ResetColor();
                Console.WriteLine();
                Campo();
                Console.ForegroundColor = ConsoleColor.Green;
                Console.WriteLine();
                Console.WriteLine("\t\t\tSituação Jogador");
                Console.WriteLine();
                VerificarAtaque();
                PercaPokemonMaquina();
                if(cartaAtualMaq.Vida <= 0)
                {
                    custoATK2 = 0;
                }
                Console.ResetColor();
                Console.WriteLine();
                Console.WriteLine("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Campo Atualizado  xxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
                Console.WriteLine();
                Campo();
                VerificarVitoriaJogador();
                if (situaçãoJogo == false)
                {
                    break;
                }
                VerificarCampoMaquina();
                situacaoFase = false;
                if (situacaoFase == false)
                {
                    break;
                }
            }

            if (situaçãoJogo == false)
            {
                break;
            }
            Console.WriteLine("Aperte ENTER para passar a vez");
            Console.ReadLine();
            Console.Clear();

            //Turno Maquina
            while (true)
            {
                Console.WriteLine("#############################  Vez da Maquina  #################################");
                Console.ForegroundColor = ConsoleColor.Red;
                RodarDadosMaquina();
                custoATK2 += moeda2;
                Console.ResetColor();
                Console.WriteLine();
                Campo();
                Console.ForegroundColor= ConsoleColor.Red;
                Console.WriteLine();
                Console.WriteLine("\t\t\tSituação Maquina");
                Console.WriteLine();
                VerificarAtaqueMaquina();
                PercaPokemonJogador();
                if (cartaAtual.Vida <= 0)
                {
                    custoATK2 = 0;
                }
                Console.ResetColor();
                Console.WriteLine();
                Console.WriteLine("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  Campo Atualizado  xxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
                Console.WriteLine();
                Campo();
                VerificarVitoriaMaquina();
                if (situaçãoJogo == false)
                {
                    break;
                }
                VerificarCampoJogador();
                situacaoFase = false;
                if (situacaoFase == false)
                {
                    break;
                }
            }

            if (situaçãoJogo == false)
            {
                break;
            }
            Console.WriteLine("Aperte ENTER para sua vez");
            Console.ReadLine();
            Console.Clear();
        }
    }
}
